import os
import argparse
import matplotlib.pyplot as plt
import numpy as np

accs = [[3.649472713470459, 4.156641483306885, 1.9536635875701904, 0.589387834072113, 0.46050354838371277, 0.19214360415935516, 0.20222137868404388, 0.1132914274930954, 0.04479293152689934, 0.14537781476974487, 0.12984883785247803, 0.11526557803153992, 0.22966518998146057, 0.011460057459771633, 0.05488331988453865, 0.06072060763835907, 0.21151462197303772, 0.07150114327669144, 0.031191786751151085, 0.0373825840651989, 0.017091864719986916, 0.10538671910762787, 0.022753266617655754, 0.11444171518087387, 0.19890223443508148, 0.03311948850750923, 0.03534514829516411, 0.10292757302522659, 0.18394359946250916, 0.027413083240389824, 0.011969455517828465, 0.06465718895196915, 0.012868252582848072, 0.0029479607474058867, 0.09252727031707764, 0.06849371641874313, 0.004106543026864529, 0.0073960027657449245, 0.0044111465103924274, 0.1598181426525116, 0.11667589843273163, 0.021923521533608437, 0.0858520045876503, 0.05130362883210182, 0.004067844711244106, 0.11182165145874023, 0.0017272422555834055, 0.001729791285470128, 0.059775274246931076, 0.2950383722782135, 0.02731701359152794, 0.000762309180572629, 0.004787917248904705, 0.039132095873355865, 0.005578870419412851, 0.0017395158065482974, 0.02888285554945469, 0.019451742991805077, 0.061128973960876465, 0.015651071444153786, 0.0079569760710001, 0.04583800584077835, 0.0918651595711708, 0.010708183981478214, 0.08333708345890045, 0.09642144292593002, 0.09062100946903229, 0.0022199100349098444, 0.023675115779042244, 0.09467530250549316, 0.0008710778201930225, 0.018319053575396538, 0.04074763506650925, 0.06302917748689651, 0.039483197033405304, 0.020644906908273697, 0.005551319103688002, 0.015078281983733177, 0.05443630367517471, 0.1181047260761261, 0.014230192638933659, 0.015402499586343765, 0.014237805269658566, 0.04292512312531471, 0.005881756544113159, 0.002975461771711707, 0.011550871655344963, 0.015243425033986568, 0.009989272803068161, 0.0037472385447472334, 0.008249175734817982, 0.018389252945780754, 0.00019903710926882923, 0.017205487936735153, 0.0005687767989002168, 0.06815726310014725, 0.007188044022768736, 0.00022517811157740653, 0.006158540956676006, 0.0038746430072933435],
        [3.222998857498169, 0.33655431866645813, 0.04846559837460518, 0.05711536854505539, 0.048255980014801025, 0.04387786239385605, 0.043303947895765305, 0.056956931948661804, 0.08464659750461578, 0.04400014132261276, 0.03793666511774063, 0.023595480248332024, 0.05686354264616966, 0.006000138353556395, 0.015703288838267326, 0.0039049990009516478, 0.06135139241814613, 0.0061510284431278706, 0.07209500670433044, 0.003940933384001255, 0.0020802246872335672, 0.006895007565617561, 0.0007558701327070594, 0.0188031904399395, 0.010789671912789345, 0.01367509551346302, 0.0018260645447298884, 0.01678146794438362, 0.17620651423931122, 0.008525041863322258, 0.014308854006230831, 0.004386430606245995, 0.0018795563373714685, 0.00034553336445242167, 0.06201796978712082, 0.04997209459543228, 0.0016608313890174031, 0.002461989875882864, 0.0013189963065087795, 0.18826325237751007, 0.003942146897315979, 0.0026092238258570433, 0.005678314249962568, 0.010706564411520958, 0.004487807396799326, 0.025710679590702057, 0.0002237981098005548, 0.007184633985161781, 0.005879407748579979, 0.019816679880023003, 0.054028723388910294, 0.000383285601856187, 0.0005730845732614398, 0.001385585987009108, 0.0009350628242827952, 0.0007600812241435051, 0.000971829635091126, 0.0016624127747491002, 0.04555457457900047, 0.0567067451775074, 0.0015469924546778202, 0.03139742463827133, 0.0033531631343066692, 0.00021727042621932924, 0.0021573847625404596, 0.009048770181834698, 0.00916216615587473, 0.09347748011350632, 0.021812641993165016, 0.02301798388361931, 0.00047488565905950963, 0.000699874886777252, 0.0005362942465581, 0.05708812177181244, 0.006362415850162506, 0.04360957443714142, 0.012660500593483448, 0.0015124346828088164, 0.005760790780186653, 0.024487141519784927, 0.0030228060204535723, 0.027223002165555954, 0.000881212530657649, 0.005610991735011339, 0.0012335020583122969, 7.187300798250362e-05, 0.0020484079141169786, 0.0012597698951140046, 0.0077596562914550304, 0.006568863056600094, 0.0017798402113839984, 0.00016069193952716887, 7.294703391380608e-05, 0.06949646770954132, 0.0012354366481304169, 0.017078952863812447, 0.004977889358997345, 0.00040270938188768923, 0.003934794571250677, 0.0006492890533991158]]
        # [0.9881188118811881, 0.9851485148514851, 0.994059405940594, 0.994059405940594, 0.995049504950495, 0.995049504950495, 0.9930693069306931, 0.9831683168316832, 0.994059405940594, 0.997029702970297, 0.9910891089108911, 0.995049504950495, 0.994059405940594, 0.9900990099009901, 0.996039603960396, 0.994059405940594, 0.998019801980198, 0.9930693069306931, 0.9930693069306931, 0.9920792079207921, 0.996039603960396, 0.996039603960396, 0.996039603960396, 0.997029702970297, 0.995049504950495, 0.9920792079207921, 0.9910891089108911, 0.995049504950495, 0.9930693069306931, 0.995049504950495],
        # [0.9928716904276986, 0.9959266802443992, 0.9969450101832994, 0.984725050916497, 0.9918533604887984, 0.9867617107942973, 0.9826883910386965, 0.9979633401221996, 0.9989816700610998, 0.9928716904276986, 0.9969450101832994, 0.994908350305499, 0.9979633401221996, 0.994908350305499, 0.9959266802443992, 0.9979633401221996, 0.9979633401221996, 0.9959266802443992, 0.9928716904276986, 0.9887983706720977, 0.9979633401221996, 0.9918533604887984, 0.9938900203665988, 0.9928716904276986, 0.9908350305498982, 0.9969450101832994, 0.9959266802443992, 0.9887983706720977, 0.9959266802443992, 0.9959266802443992],
        # [0.9798206278026906, 0.9932735426008968, 0.9798206278026906, 0.9899103139013453, 0.9887892376681614, 0.9943946188340808, 0.9786995515695067, 0.9943946188340808, 0.984304932735426, 0.9887892376681614, 0.9932735426008968, 0.984304932735426, 0.992152466367713, 0.9966367713004485, 0.9865470852017937, 0.9943946188340808, 0.984304932735426, 0.9943946188340808, 0.9943946188340808, 0.9899103139013453, 0.9943946188340808, 0.9775784753363229, 0.9932735426008968, 0.9910313901345291, 0.9943946188340808, 0.9943946188340808, 0.9977578475336323, 0.9910313901345291, 0.9910313901345291, 0.992152466367713],
        # [0.9874739039665971, 0.9603340292275574, 0.9926931106471816, 0.9843423799582464, 0.988517745302714, 0.9853862212943633, 0.9958246346555324, 0.988517745302714, 0.9895615866388309, 0.9874739039665971, 0.9947807933194155, 0.9801670146137788, 0.9843423799582464, 0.9937369519832986, 0.9906054279749478, 0.9937369519832986, 0.9916492693110647, 0.9947807933194155, 0.9947807933194155, 0.988517745302714, 0.9874739039665971, 0.9906054279749478, 0.9947807933194155, 0.9895615866388309, 0.9947807933194155, 0.9906054279749478, 0.9926931106471816, 0.9916492693110647, 0.9926931106471816, 0.9926931106471816],
        # [0.9863813229571985, 0.9902723735408561, 0.9873540856031129, 0.9892996108949417, 0.9824902723735408, 0.9902723735408561, 0.9873540856031129, 0.9980544747081712, 0.9902723735408561, 0.9844357976653697, 0.995136186770428, 0.9970817120622568, 0.9902723735408561, 0.9961089494163424, 0.9892996108949417, 0.9912451361867705, 0.9912451361867705, 0.9912451361867705, 0.995136186770428, 0.9892996108949417, 0.9902723735408561, 0.9873540856031129, 0.9824902723735408, 0.9922178988326849, 0.9863813229571985, 0.9922178988326849, 0.9912451361867705, 0.9873540856031129, 0.995136186770428, 0.9912451361867705],
        # [0.9804928131416838, 0.9753593429158111, 0.9897330595482546, 0.9958932238193019, 0.9907597535934292, 0.9948665297741273, 0.9876796714579056, 0.9928131416837782, 0.9897330595482546, 0.9928131416837782, 0.9969199178644764, 0.9958932238193019, 0.9917864476386037, 0.9887063655030801, 0.9969199178644764, 0.9907597535934292, 0.9907597535934292, 0.9958932238193019, 0.9938398357289527, 0.9907597535934292, 0.9938398357289527, 0.9907597535934292, 0.9948665297741273, 0.9958932238193019, 0.9938398357289527, 0.9917864476386037, 0.9907597535934292, 0.9917864476386037, 0.9928131416837782, 0.9928131416837782],
        # [0.9593657086223984, 0.9504459861248761, 0.9623389494549058, 0.9861248761149654, 0.9732408325074331, 0.9890981169474727, 0.9890981169474727, 0.9425173439048563, 0.9821605550049554, 0.9821605550049554, 0.9890981169474727, 0.9890981169474727, 0.977205153617443, 0.9732408325074331, 0.981169474727453, 0.9841427155599604, 0.9762140733399405, 0.9861248761149654, 0.9851337958374629, 0.9881070366699702, 0.9890981169474727, 0.9890981169474727, 0.9861248761149654, 0.9801783944499505, 0.9841427155599604, 0.9841427155599604, 0.9851337958374629, 0.9910802775024777, 0.9801783944499505, 0.9831516352824579]]

def read_data(dir_path):
    with open(dir_path, "r") as f:
        raw_data = f.read()
        data = raw_data[1:-1].split(", ")
    return np.asfarray(data, float)

def draw_curve(folder_path, f_names):
    plt.figure()

    ax = plt.axes()
    ax.spines['top'].set_visible(False)
    ax.spines['right'].set_visible(False)

    plt.xlabel('epochs')    # x轴标签
    plt.ylabel('acc')     # y轴标签
    
    color = ['g','b','r']
    lss = ['--','-.',':']
    marker_ = ['*','o','+']
    lbl = ['lr=0.001','lr=0.003','lr=0.01']
    
    idx = 0

    for filename in f_names:
        file_path = os.path.join(folder_path, filename)
        y_loss = read_data(file_path)
        x_val = range(1, len(y_loss)+1)

        plt.plot(x_val, y_loss,label=lbl[idx],c=color[idx],ls=lss[idx],marker=marker_[idx], alpha=0.5)
        plt.legend(loc='center', bbox_to_anchor=(0.7, 0.85))
        
        idx = idx + 1
    
    plt.title('Loss Curve')
    plt.show()

def draw_curve4classification():
    plt.figure()

    ax = plt.axes()
    ax.spines['top'].set_visible(False)
    ax.spines['right'].set_visible(False)

    plt.xlabel('epochs')    # x轴标签
    plt.ylabel('loss')     # y轴标签
    
    color = ['g','b','r']
    lss = ['--','-.',':']
    marker_ = ['*','o','+']
    lbl = ['Softplus','ReLU']
    
    idx = 0

    for i in range(0,2):
        y_loss = accs[i]
        x_val = range(1, len(y_loss)+1)

        plt.plot(x_val, y_loss,label=lbl[i], alpha=0.5)
        plt.legend(loc='center', bbox_to_anchor=(0.7, 0.85))
        
        idx = idx + 1
    
    plt.title('Loss Curve for Activation')
    plt.show()

if __name__ == '__main__':
    
    folder_path = "./Results/"
    file_names = ["Loss_batch_10000_layer_10.txt","loss.txt"]

    # draw_curve(folder_path, file_names)
    draw_curve4classification()